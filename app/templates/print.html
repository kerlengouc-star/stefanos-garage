{% extends 'base.html' %}
{% block content %}
<div class="no-print d-flex gap-2 mb-3">
  <a class="btn btn-outline-secondary" href="/visits/{{ visit.id }}">Πίσω</a>
  <button class="btn btn-primary" onclick="window.print()">Print</button>
  <a class="btn btn-outline-primary" href="/visits/{{ visit.id }}/pdf" target="_blank">PDF</a>
</div>

<div class="card">
  <div class="card-body">
    <div class="fs-4 fw-semibold mb-2">Job Card</div>
    <div class="row">
      <div class="col-md-6">
<div><b>Πινακίδα:</b> <span class="mono">{{ visit.plate_number or '' }}</span></div>
        <div><b>VIN:</b> <span class="mono">{{ visit.vin or '' }}</span></div>
        <div><b>Μοντέλο:</b> {{ visit.model or '' }}</div>
        <div><b>KM:</b> {{ visit.km or '' }}</div>
      </div>
      <div class="col-md-6">
        <div><b>Πελάτης:</b> {{ visit.customer_name or '' }}</div>
        <div><b>Τηλέφωνο:</b> <span class="mono">{{ visit.phone or '' }}</span></div>
        <div><b>Email:</b> <span class="mono">{{ visit.email or '' }}</span></div>
        <div><b>Άφιξη:</b> <span class="mono">{{ visit.date_in.strftime('%d/%m/%Y %H:%M') if visit.date_in else '' }}</span></div>
        <div><b>Παράδοση:</b> <span class="mono">{{ visit.date_out.strftime('%d/%m/%Y %H:%M') if visit.date_out else '' }}</span></div>
      </div>
    </div>

    {% if visit.customer_complaint %}
    <hr>
    <div><b>Απαίτηση / Σχόλια:</b></div>
    <div style="white-space: pre-wrap">{{ visit.customer_complaint }}</div>
    {% endif %}

    <hr>
    <div class="fw-semibold mb-2">Επιλεγμένες Εργασίες</div>
    <table class="table table-sm">
      <thead>
        <tr>
          <th>Κατηγορία</th>
          <th>Εργασία</th>
          <th>Status</th>
          <th>Parts No</th>
          <th>Qty</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        {% for ln in lines %}
        <tr>
          <td>{{ ln.category or '' }}</td>
          <td>{{ ln.item_name or '' }}</td>
          <td class="mono">{{ (ln.result or '') }}</td>
          <td class="mono">{{ ln.parts_code or '' }}</td>
          <td class="mono">{{ ln.parts_qty or 0 }}</td>
          <td>{{ ln.notes or '' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
